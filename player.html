<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Live Player</title>
<script src="https://cdn.tailwindcss.com"></script>
<!-- HLS.js for .m3u8 streaming -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<link rel="stylesheet" href="assets/css/style.css">
</head>
<body class="bg-gray-900 text-white flex flex-col items-center justify-center min-h-screen">

<!-- Header -->
<h1 id="channelName" class="text-2xl font-bold mb-4"></h1>

<!-- Video Player -->
<div class="relative w-full max-w-4xl">
  <video id="videoPlayer" class="w-full rounded-lg shadow-lg" controls autoplay></video>
  
  <!-- Optional overlay for premium features -->
  <div id="premiumOverlay" class="absolute top-0 left-0 w-full h-full flex items-center justify-center text-xl font-semibold text-white bg-black/50 hidden">
    Premium Feature Active
  </div>
</div>

<!-- Player Controls -->
<div class="flex space-x-4 mt-4">
  <button id="btnFullscreen" class="px-4 py-2 bg-purple-600 rounded hover:bg-purple-700">Fullscreen</button>
  <button id="btnToggleOverlay" class="px-4 py-2 bg-purple-600 rounded hover:bg-purple-700">Toggle Premium Overlay</button>
</div>

<script type="module">
  // Parse query parameters
  const urlParams = new URLSearchParams(window.location.search);
  const channelName = urlParams.get('name');
  const streamURL = decodeURIComponent(urlParams.get('stream'));

  const video = document.getElementById('videoPlayer');
  const nameEl = document.getElementById('channelName');
  const overlay = document.getElementById('premiumOverlay');

  nameEl.textContent = channelName || "Unknown Channel";

  // HLS streaming for .m3u8
  if (Hls.isSupported()) {
    const hls = new Hls();
    hls.loadSource(streamURL);
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED, () => {
      video.play();
    });
  } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    video.src = streamURL;
    video.addEventListener('loadedmetadata', () => video.play());
  } else {
    alert("Your browser does not support HLS streaming.");
  }

  // Fullscreen button
  document.getElementById('btnFullscreen').onclick = () => {
    if (video.requestFullscreen) video.requestFullscreen();
    else if (video.webkitEnterFullscreen) video.webkitEnterFullscreen();
  };

  // Toggle premium overlay
  document.getElementById('btnToggleOverlay').onclick = () => {
    overlay.classList.toggle('hidden');
  };

  // Optional: Log playback events for premium analytics
  video.addEventListener('play', () => console.log(`${channelName} started playing`));
  video.addEventListener('pause', () => console.log(`${channelName} paused`));
</script>
</body>
</html>