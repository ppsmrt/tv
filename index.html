<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>Live TV - Premium UI</title>

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>

<style>
  body {
    font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    background: #f9fafb;
    margin: 0;
    min-height: 100vh;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

  /* Header */
  header {
    position: fixed; top:0; left:0; right:0; height:64px;
    background: rgba(255,255,255,0.95); backdrop-filter: blur(6px);
    box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    display:flex; align-items:center; justify-content:space-between; padding:0 1.5rem; z-index:100;
  }
  header h1 { font-weight:700; font-size:1.5rem; letter-spacing:0.05em; color:#111827; }

  .search-container { position:relative; width:280px; }
  .search-container input {
    width:100%; padding:8px 40px 8px 16px; border-radius:9999px;
    border:1.5px solid #d1d5db; font-size:1rem; font-weight:500; color:#374151;
    background:#f3f4f6; transition:0.3s; 
  }
  .search-container input:focus { outline:none; border-color:#3b82f6; box-shadow:0 0 8px #3b82f6aa; background:white; }
  .search-container .material-icons { position:absolute; right:12px; top:50%; transform:translateY(-50%); color:#3b82f6; font-size:20px; pointer-events:none; }

  main { padding:80px 1.5rem 96px; max-width:1200px; margin:0 auto; }

  .category-bar { display:flex; gap:16px; margin-bottom:24px; overflow-x:auto; scrollbar-width:none; -ms-overflow-style:none; }
  .category-bar::-webkit-scrollbar { display:none; }
  .category-btn {
    flex-shrink:0; padding:8px 20px; border-radius:9999px;
    font-weight:600; font-size:0.875rem; color:#6b7280; background:#e5e7eb;
    cursor:pointer; transition:0.3s; white-space:nowrap; border:none;
  }
  .category-btn:hover { background:#3b82f6; color:white; }
  .category-btn.active { background:#3b82f6; color:white; box-shadow:0 4px 12px rgb(59 130 246 / 0.4); }

  .channels-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); gap:24px; }

  .channel-card {
    position:relative; background:white; border-radius:16px; overflow:hidden;
    box-shadow:0 4px 12px rgb(0 0 0 / 0.08); cursor:pointer;
    display:flex; flex-direction:column; transition:transform 0.3s ease, box-shadow 0.3s ease, opacity 0.5s ease;
    opacity:0; transform:translateY(20px);
  }
  .channel-card.show { opacity:1; transform:translateY(0); }
  .channel-card:hover, .channel-card:focus-visible { transform:translateY(-6px); box-shadow:0 12px 24px rgb(59 130 246 / 0.3); }

  .channel-image { width:100%; aspect-ratio:16/9; object-fit:cover; border-bottom:1px solid #e5e7eb; transition:filter 0.3s ease; }
  .channel-card:hover .channel-image { filter:brightness(1.1); }

  .channel-overlay {
    position:absolute; inset:0; background:rgba(0,0,0,0.35);
    display:flex; align-items:center; justify-content:center; color:white;
    font-weight:700; font-size:1rem; opacity:0; transition:opacity 0.3s ease;
  }
  .channel-card:hover .channel-overlay { opacity:1; }

  .channel-name { padding:12px 8px; font-weight:700; font-size:1.125rem; text-align:center; user-select:text; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

  footer {
    position:fixed; bottom:0; left:0; right:0; height:64px;
    background:white; box-shadow:0 -2px 12px rgba(0,0,0,0.08);
    display:flex; justify-content:space-around; align-items:center; z-index:100;
  }
  .bottom-nav-btn {
    display:flex; flex-direction:column; align-items:center; font-weight:600; font-size:0.75rem; color:#6b7280;
    cursor:pointer; transition:color 0.3s ease, transform 0.3s ease; border:none; background:none; padding:0;
  }
  .bottom-nav-btn .material-icons { font-size:24px; margin-bottom:2px; transition:filter 0.3s ease; }
  .bottom-nav-btn:hover, .bottom-nav-btn:focus-visible { color:#3b82f6; outline:none; transform:scale(1.15); }
  .bottom-nav-btn.active { color:#3b82f6; transform:scale(1.25); font-weight:700; }
  .bottom-nav-btn.active .material-icons { filter:drop-shadow(0 0 6px #3b82f6); }

  @media(max-width:640px){ .channels-grid{grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:16px;} .channel-name{font-size:1rem;} }
</style>
</head>
<body>

<header>
  <h1>Live TV</h1>
  <div class="search-container">
    <input type="search" id="searchInput" placeholder="Search channels..." aria-label="Search channels"/>
    <span class="material-icons">search</span>
  </div>
</header>

<main>
  <nav class="category-bar" role="navigation" aria-label="Channel categories">
    <button class="category-btn active" data-category="All" aria-pressed="true">All</button>
    <button class="category-btn" data-category="News" aria-pressed="false">News</button>
    <button class="category-btn" data-category="Music" aria-pressed="false">Music</button>
    <button class="category-btn" data-category="Entertainment" aria-pressed="false">Entertainment</button>
  </nav>

  <section class="channels-grid" id="channelsGrid" aria-live="polite" aria-relevant="additions removals"></section>
</main>

<footer role="navigation">
  <button class="bottom-nav-btn active"><span class="material-icons">home</span>Home</button>
  <button class="bottom-nav-btn"><span class="material-icons">live_tv</span>Live</button>
  <button class="bottom-nav-btn"><span class="material-icons">search</span>Search</button>
  <button class="bottom-nav-btn"><span class="material-icons">person</span>Profile</button>
</footer>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB9GaCbYFH22WbiLs1pc_UJTsM_0Tetj6E",
    authDomain: "tnm3ulive.firebaseapp.com",
    databaseURL: "https://tnm3ulive-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "tnm3ulive",
    storageBucket: "tnm3ulive.firebasestorage.app",
    messagingSenderId: "80664356882",
    appId: "1:80664356882:web:c8464819b0515ec9b210cb",
    measurementId: "G-FNS9JWZ9LS"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const grid = document.getElementById('channelsGrid');
  const searchInput = document.getElementById('searchInput');
  const categoryButtons = document.querySelectorAll('.category-btn');
  let selectedCategory = 'All';
  let channels = [];

  function createChannelCard(c) {
    const a = document.createElement('a');
    // Use player.html with stream parameter
    const safeName = encodeURIComponent(c.name.toLowerCase().replace(/\s+/g,'-'));
    a.href = `test.html?stream=${safeName}`;
    a.className = 'channel-card';
    a.setAttribute('aria-label', `Watch ${c.name}`);

    const img = document.createElement('img');
    img.src = c.logo; img.alt = c.name + ' logo'; img.className = 'channel-image';

    const overlay = document.createElement('div');
    overlay.className = 'channel-overlay';
    overlay.textContent = 'â–¶ Watch';

    const nameDiv = document.createElement('div');
    nameDiv.className = 'channel-name';
    nameDiv.textContent = c.name;

    a.appendChild(img); a.appendChild(overlay); a.appendChild(nameDiv);
    return a;
  }

  function renderChannels(filter='') {
    grid.innerHTML = '';
    const filtered = channels.filter(c => {
      const matchCat = selectedCategory === 'All' || c.category === selectedCategory;
      const matchSearch = c.name.toLowerCase().includes(filter.toLowerCase());
      return matchCat && matchSearch;
    });
    if (filtered.length === 0) {
      grid.innerHTML = '<p style="color:#9ca3af; padding:1rem; text-align:center;">No channels found.</p>';
      return;
    }
    filtered.forEach((c, i) => {
      const card = createChannelCard(c);
      grid.appendChild(card);
      setTimeout(() => card.classList.add('show'), i * 100);
    });
  }

  categoryButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      categoryButtons.forEach(b => { b.classList.remove('active'); b.setAttribute('aria-pressed','false'); });
      btn.classList.add('active'); btn.setAttribute('aria-pressed','true');
      selectedCategory = btn.dataset.category;
      renderChannels(searchInput.value);
    });
  });

  searchInput.addEventListener('input', e => renderChannels(e.target.value));

  const channelsRef = ref(db, 'channels');
  onValue(channelsRef, snapshot => {
    if (snapshot.exists()) {
      const data = snapshot.val();
      channels = Object.values(data).map(c => ({
        name: c.name,
        category: c.category,
        logo: c.icon,
        stream: c.stream
      }));
      renderChannels(searchInput.value);
    } else {
      grid.innerHTML = '<p style="color:#9ca3af; padding:1rem; text-align:center;">No channels available.</p>';
    }
  });
</script>
</body>
</html>